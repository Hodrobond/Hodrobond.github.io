{"componentChunkName":"component---src-templates-blog-post-js","path":"/project-euler-14/","result":{"data":{"site":{"siteMetadata":{"title":"Contemplating Imponderables"}},"markdownRemark":{"id":"5d13c9ea-e0fe-5666-83bd-dace5547d3cb","excerpt":"Longest Collatz sequence The following iterative sequence is defined for the set of positive integers:\nn → n/2 (n is even)\nn → 3n + 1 (n is odd)\nUsing the rule…","html":"<h3>Longest Collatz sequence</h3>\n<blockquote>\n<p>The following iterative sequence is defined for the set of positive integers:<br/><br/>\nn → n/2 (n is even)<br/>\nn → 3n + 1 (n is odd)<br/><br/>\nUsing the rule above and starting with 13, we generate the following sequence:<br/><br/>\n13 → 40 → 20 → 10 → 5 → 16 → 8 → 4 → 2 → 1<br/><br/>\nIt can be seen that this sequence (starting at 13 and finishing at 1) contains 10 terms. Although it has not been proved yet (Collatz Problem), it is thought that all starting numbers finish at 1.<br/>\nWhich starting number, under one million, produces the longest chain?<br/>\nNOTE: Once the chain starts the terms are allowed to go above one million.</p>\n</blockquote>\n<p>Brute force:</p>\n<p>{% highlight javascript %}\nfunction getCollatzChainLength(n){\nvar chain = [];\nvar chainCount = 1;\nwhile(n !== 1){\nchainCount++;\nif(n%2 === 0)\nn <em>= 0.5\nelse\nn = 3</em>n+1;\n}\nreturn chainCount;\n}</p>\n<p>  function getSolution(n){\nvar n = 1000000;\nvar bestLength = 0;\nvar bestNum = 0;\nfor(var i=n; i>0; i—){\nvar chain = getCollatzChainLength(i);\nif(chain > bestLength){\nbestLength = chain;\nbestNum = i;\n}\n}\nreturn bestNum;\n}\n{% endhighlight %}</p>\n<p>Runtime (average of 100 iterations):<br/>\n2209.2250000000004 ms</p>\n<p>Now let’s see what we can improve about this. Maybe something along the line of caching our previous Collatz lengths?<br/>\nLet’s look at the number <code class=\"language-text\">13</code>, which has a length of 10. When we get to 26, we need to recalculate all 10 links of the 13 chain. That looks like it could be improved! Maybe with something like:</p>\n<p>{% highlight javascript %}\nvar collatzLength = [0,1];\nfunction getCollatzChainLength(n){\nif(collatzLength[n])\nreturn collatzLength[n];\nif(n%2 === 0){\nvar length = getCollatzChainLength(n<em>0.5) + 1;\ncollatzLength[n] = length;\nreturn length;\n}\nelse{\nvar length = getCollatzChainLength(3</em>n+1) + 1;\ncollatzLength[n] = length;\nreturn length;\n}\n}\n{% endhighlight %}</p>\n<p>Updated runtime (average of 100 iterations):<br/>\n1191.455 ms</p>\n<p>Well, caching was faster, let’s actually figure out a quantitative value for how many calculations we let the computer skip!<br/>\nIf we add <code class=\"language-text\">var skippedLength = 0</code> as a global var and update the following line:</p>\n<p>{% highlight javascript %}\nif(collatzLength[n]){\nskippedLength += collatzLength[n];\nreturn collatzLength[n];<br>\n}\n{% endhighlight %}</p>\n<p>We can see exactly how many chain iterations we skipped:<br/><code class=\"language-text\">67,631,017</code>.<br/>How many there were total:<br/><code class=\"language-text\">69,799,628</code>.<br/>Which means there was only <code class=\"language-text\">2,168,611</code> unique chain numbers and we skipped about 97% of recalculations!<br/>\nIf we skipped 97% of calculations, why does it still take 50%~ as long though, shouldn’t that number be closer to…3%?<br/>\nIt looks like array manipulation takes up the remainder of our boost, our chain array has a length of <code class=\"language-text\">4,286,786,813</code>, and manipulating arrays of that size definitely takes some effort.</p>\n<p>My Naivete is showing, nothing else is jumping at me eager for efficiency.</p>","frontmatter":{"title":"Let's Solve Project Euler Problem 14","date":"June 27, 2017","description":"Euler Problem 14"}}},"pageContext":{"slug":"/project-euler-14/","previous":{"fields":{"slug":"/project-euler-13/"},"frontmatter":{"title":"Let's Solve Project Euler Problem 13"}},"next":{"fields":{"slug":"/project-euler-15/"},"frontmatter":{"title":"Let's Solve Project Euler Problem 15"}}}},"staticQueryHashes":["1246554614","2841359383"]}